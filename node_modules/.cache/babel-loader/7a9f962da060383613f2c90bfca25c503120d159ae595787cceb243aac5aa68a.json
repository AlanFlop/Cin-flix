{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapState, mapGetters, mapActions } from 'vuex';\nexport default {\n  name: 'CartView',\n  data() {\n    return {\n      loading: false,\n      checkoutLoading: false,\n      error: null\n    };\n  },\n  computed: {\n    ...mapState('cart', {\n      cartItems: state => state.items || [] // Ajout d'une valeur par dÃ©faut\n    }),\n    ...mapGetters('auth', ['isLoggedIn', 'currentUser']),\n    ...mapGetters('cart', ['isEmpty', 'cartTotal']),\n    taxes() {\n      // TVA Ã  20%\n      return this.cartTotal * 0.2;\n    },\n    orderTotal() {\n      return this.cartTotal + this.taxes;\n    }\n  },\n  methods: {\n    ...mapActions('cart', ['updateCartItem', 'removeFromCart', 'checkout']),\n    formatPrice(price) {\n      return new Intl.NumberFormat('fr-FR', {\n        style: 'currency',\n        currency: 'EUR'\n      }).format(price);\n    },\n    formatDate(dateString) {\n      const options = {\n        weekday: 'long',\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      };\n      const date = new Date(dateString);\n      return date.toLocaleDateString('fr-FR', options);\n    },\n    getPosterUrl(item) {\n      if (!item.moviePoster || item.moviePoster === 'N/A') {\n        return 'https://via.placeholder.com/150x225?text=No+Image';\n      }\n      return item.moviePoster;\n    },\n    updateQuantity(index, quantity) {\n      if (quantity >= 1 && quantity <= 10) {\n        this.updateCartItem({\n          index,\n          quantity\n        });\n      }\n    },\n    removeItem(index) {\n      if (confirm('ÃŠtes-vous sÃ»r de vouloir supprimer cet article du panier ?')) {\n        this.removeFromCart(index);\n      }\n    },\n    async processCheckout() {\n      if (!this.isLoggedIn) {\n        // Rediriger vers la page de connexion avec un paramÃ¨tre pour revenir au panier\n        this.$router.push('/login?redirect=cart');\n        return;\n      }\n      this.checkoutLoading = true;\n      try {\n        // VÃ©rifier que l'utilisateur est connectÃ© et a un ID\n        if (!this.currentUser || !this.currentUser.id) {\n          throw new Error('Veuillez vous reconnecter pour continuer');\n        }\n        const result = await this.checkout();\n        console.log('Commande effectuÃ©e:', result);\n\n        // Afficher un message de succÃ¨s\n        if (this.$toasted) {\n          this.$toasted.success('Commande effectuÃ©e avec succÃ¨s !');\n        } else {\n          alert('Commande effectuÃ©e avec succÃ¨s !');\n        }\n\n        // Rediriger vers la page de profil\n        this.$router.push('/profile');\n      } catch (error) {\n        console.error('Erreur lors de la finalisation de la commande:', error);\n\n        // Afficher un message d'erreur\n        const errorMessage = error.message || 'Une erreur est survenue lors de la finalisation de la commande';\n        if (this.$toasted) {\n          this.$toasted.error(errorMessage);\n        } else {\n          alert('Erreur: ' + errorMessage);\n        }\n      } finally {\n        this.checkoutLoading = false;\n      }\n    }\n  }\n};","map":{"version":3,"names":["mapState","mapGetters","mapActions","name","data","loading","checkoutLoading","error","computed","cartItems","state","items","taxes","cartTotal","orderTotal","methods","formatPrice","price","Intl","NumberFormat","style","currency","format","formatDate","dateString","options","weekday","year","month","day","date","Date","toLocaleDateString","getPosterUrl","item","moviePoster","updateQuantity","index","quantity","updateCartItem","removeItem","confirm","removeFromCart","processCheckout","isLoggedIn","$router","push","currentUser","id","Error","result","checkout","console","log","$toasted","success","alert","errorMessage","message"],"sources":["/Users/alandelaigue/Desktop/cinema-v2/src/views/CartView.vue"],"sourcesContent":["<template>\n  <div class=\"cart-view\">\n    <h1>Mon panier</h1>\n    \n    <div v-if=\"loading\" class=\"loading\">\n      <div class=\"spinner\"></div>\n      <p>Chargement du panier...</p>\n    </div>\n    \n    <div v-else-if=\"isEmpty\" class=\"empty-cart\">\n      <div class=\"empty-state\">\n        <div class=\"empty-icon\">ðŸ›’</div>\n        <h2>Votre panier est vide</h2>\n        <p>Parcourez nos films et ajoutez des billets Ã  votre panier.</p>\n        <router-link to=\"/\" class=\"btn\">Parcourir les films</router-link>\n      </div>\n    </div>\n    \n    <div v-else class=\"cart-content\">\n      <div class=\"cart-items\">\n        <div v-for=\"(item, index) in cartItems\" :key=\"index\" class=\"cart-item\">\n          <div class=\"item-poster\">\n            <img :src=\"getPosterUrl(item)\" :alt=\"item.movieTitle\">\n          </div>\n          \n          <div class=\"item-details\">\n            <h3 class=\"item-title\">{{ item.movieTitle }}</h3>\n            <p class=\"item-session\">{{ formatDate(item.date) }} Ã  {{ item.time }}</p>\n            \n            <div class=\"item-quantity\">\n              <label>QuantitÃ©:</label>\n              <div class=\"quantity-control\">\n                <button \n                  @click=\"updateQuantity(index, item.quantity - 1)\"\n                  :disabled=\"item.quantity <= 1\"\n                  class=\"qty-btn\"\n                >-</button>\n                <span class=\"qty-value\">{{ item.quantity }}</span>\n                <button \n                  @click=\"updateQuantity(index, item.quantity + 1)\"\n                  :disabled=\"item.quantity >= 10\"\n                  class=\"qty-btn\"\n                >+</button>\n              </div>\n            </div>\n          </div>\n          \n          <div class=\"item-price\">\n            <p class=\"price-value\">{{ formatPrice(item.totalPrice) }}</p>\n            <button @click=\"removeItem(index)\" class=\"remove-btn\">\n              Supprimer\n            </button>\n          </div>\n        </div>\n      </div>\n      \n      <div class=\"cart-summary\">\n        <h2>RÃ©capitulatif</h2>\n        <div class=\"summary-line\">\n          <span>Sous-total:</span>\n          <span>{{ formatPrice(cartTotal) }}</span>\n        </div>\n        <div class=\"summary-line\">\n          <span>Taxes:</span>\n          <span>{{ formatPrice(taxes) }}</span>\n        </div>\n        <div class=\"summary-line total\">\n          <span>Total:</span>\n          <span>{{ formatPrice(orderTotal) }}</span>\n        </div>\n        \n        <div class=\"checkout-actions\">\n          <button @click=\"processCheckout\" class=\"btn checkout-btn\" :disabled=\"checkoutLoading\">\n            {{ checkoutLoading ? 'Traitement en cours...' : 'Finaliser la commande' }}\n          </button>\n          <router-link to=\"/\" class=\"btn secondary\">Continuer mes achats</router-link>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapGetters, mapActions } from 'vuex'\n\nexport default {\n  name: 'CartView',\n  data() {\n    return {\n      loading: false,\n      checkoutLoading: false,\n      error: null\n    }\n  },\n  computed: {\n    ...mapState('cart', {\n      cartItems: state => state.items || [] // Ajout d'une valeur par dÃ©faut\n    }),\n    ...mapGetters('auth', ['isLoggedIn', 'currentUser']),\n    ...mapGetters('cart', ['isEmpty', 'cartTotal']),\n    taxes() {\n      // TVA Ã  20%\n      return this.cartTotal * 0.2\n    },\n    orderTotal() {\n      return this.cartTotal + this.taxes\n    }\n  },\n  methods: {\n    ...mapActions('cart', ['updateCartItem', 'removeFromCart', 'checkout']),\n    formatPrice(price) {\n      return new Intl.NumberFormat('fr-FR', {\n        style: 'currency',\n        currency: 'EUR'\n      }).format(price)\n    },\n    formatDate(dateString) {\n      const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }\n      const date = new Date(dateString)\n      return date.toLocaleDateString('fr-FR', options)\n    },\n    getPosterUrl(item) {\n      if (!item.moviePoster || item.moviePoster === 'N/A') {\n        return 'https://via.placeholder.com/150x225?text=No+Image'\n      }\n      return item.moviePoster\n    },\n    updateQuantity(index, quantity) {\n      if (quantity >= 1 && quantity <= 10) {\n        this.updateCartItem({ index, quantity })\n      }\n    },\n    removeItem(index) {\n      if (confirm('ÃŠtes-vous sÃ»r de vouloir supprimer cet article du panier ?')) {\n        this.removeFromCart(index)\n      }\n    },\n    async processCheckout() {\n      if (!this.isLoggedIn) {\n        // Rediriger vers la page de connexion avec un paramÃ¨tre pour revenir au panier\n        this.$router.push('/login?redirect=cart')\n        return\n      }\n      \n      this.checkoutLoading = true\n      \n      try {\n        // VÃ©rifier que l'utilisateur est connectÃ© et a un ID\n        if (!this.currentUser || !this.currentUser.id) {\n          throw new Error('Veuillez vous reconnecter pour continuer')\n        }\n        \n        const result = await this.checkout()\n        console.log('Commande effectuÃ©e:', result)\n        \n        // Afficher un message de succÃ¨s\n        if (this.$toasted) {\n          this.$toasted.success('Commande effectuÃ©e avec succÃ¨s !')\n        } else {\n          alert('Commande effectuÃ©e avec succÃ¨s !')\n        }\n        \n        // Rediriger vers la page de profil\n        this.$router.push('/profile')\n      } catch (error) {\n        console.error('Erreur lors de la finalisation de la commande:', error)\n        \n        // Afficher un message d'erreur\n        const errorMessage = error.message || 'Une erreur est survenue lors de la finalisation de la commande'\n        if (this.$toasted) {\n          this.$toasted.error(errorMessage)\n        } else {\n          alert('Erreur: ' + errorMessage)\n        }\n      } finally {\n        this.checkoutLoading = false\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.cart-view {\n  max-width: 1000px;\n  margin: 0 auto;\n  padding: 1rem;\n}\n\nh1 {\n  margin-bottom: 2rem;\n  color: #333;\n}\n\n.loading, .empty-cart {\n  text-align: center;\n  padding: 3rem 0;\n}\n\n.spinner {\n  display: inline-block;\n  width: 50px;\n  height: 50px;\n  border: 5px solid rgba(229, 9, 20, 0.3);\n  border-radius: 50%;\n  border-top-color: #e50914;\n  animation: spin 1s ease-in-out infinite;\n  margin-bottom: 1rem;\n}\n\n@keyframes spin {\n  to { transform: rotate(360deg); }\n}\n\n.empty-state {\n  max-width: 400px;\n  margin: 0 auto;\n}\n\n.empty-icon {\n  font-size: 3rem;\n  margin-bottom: 1rem;\n}\n\n.empty-state h2 {\n  margin-bottom: 1rem;\n}\n\n.empty-state p {\n  margin-bottom: 1.5rem;\n  color: #666;\n}\n\n.cart-content {\n  display: grid;\n  grid-template-columns: 1fr 300px;\n  gap: 2rem;\n}\n\n.cart-items {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.cart-item {\n  display: grid;\n  grid-template-columns: 100px 1fr auto;\n  gap: 1rem;\n  background-color: white;\n  border-radius: 8px;\n  padding: 1rem;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.item-poster img {\n  width: 100%;\n  height: 150px;\n  object-fit: cover;\n  border-radius: 4px;\n}\n\n.item-title {\n  font-size: 1.2rem;\n  margin-bottom: 0.5rem;\n}\n\n.item-session {\n  color: #666;\n  margin-bottom: 1rem;\n}\n\n.item-quantity {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n\n.quantity-control {\n  display: flex;\n  align-items: center;\n}\n\n.qty-btn {\n  width: 30px;\n  height: 30px;\n  background-color: #f5f5f5;\n  border: 1px solid #ddd;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n}\n\n.qty-btn:first-child {\n  border-radius: 4px 0 0 4px;\n}\n\n.qty-btn:last-child {\n  border-radius: 0 4px 4px 0;\n}\n\n.qty-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.qty-value {\n  width: 30px;\n  height: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-top: 1px solid #ddd;\n  border-bottom: 1px solid #ddd;\n}\n\n.item-price {\n  text-align: right;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n\n.price-value {\n  font-weight: 600;\n  font-size: 1.1rem;\n}\n\n.remove-btn {\n  background: none;\n  border: none;\n  color: #e50914;\n  cursor: pointer;\n  font-size: 0.9rem;\n  padding: 0;\n}\n\n.remove-btn:hover {\n  text-decoration: underline;\n}\n\n.cart-summary {\n  background-color: white;\n  border-radius: 8px;\n  padding: 1.5rem;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  height: fit-content;\n}\n\n.cart-summary h2 {\n  margin-bottom: 1.5rem;\n  color: #333;\n  font-size: 1.5rem;\n}\n\n.summary-line {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 1rem;\n}\n\n.summary-line.total {\n  margin-top: 1rem;\n  padding-top: 1rem;\n  border-top: 1px solid #ddd;\n  font-weight: 600;\n  font-size: 1.1rem;\n}\n\n.checkout-actions {\n  margin-top: 2rem;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.btn {\n  display: block;\n  width: 100%;\n  padding: 0.8rem;\n  border: none;\n  border-radius: 4px;\n  background-color: #e50914;\n  color: white;\n  font-weight: 600;\n  text-align: center;\n  cursor: pointer;\n  transition: background-color 0.3s;\n  text-decoration: none;\n}\n\n.btn:hover {\n  background-color: #f40612;\n}\n\n.btn.secondary {\n  background-color: #666;\n}\n\n.btn.secondary:hover {\n  background-color: #555;\n}\n\n.btn:disabled {\n  background-color: #ccc;\n  cursor: not-allowed;\n}\n\n@media (max-width: 768px) {\n  .cart-content {\n    grid-template-columns: 1fr;\n  }\n  \n  .cart-item {\n    grid-template-columns: 80px 1fr;\n    grid-template-areas: \n      \"poster details\"\n      \"poster price\";\n  }\n  \n  .item-poster {\n    grid-area: poster;\n  }\n  \n  .item-details {\n    grid-area: details;\n  }\n  \n  .item-price {\n    grid-area: price;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    margin-top: 1rem;\n  }\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}